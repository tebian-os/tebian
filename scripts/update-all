#!/bin/bash

echo "ğŸš€ Starting Full System Update..."

# 1. Debian System Packages
echo -e "
ğŸ“¦ Updating Debian packages..."
sudo apt update && sudo apt upgrade -y

# 2. Rust / Cargo
if command -v rustup &> /dev/null; then
    echo -e "
ğŸ¦€ Updating Rust and Cargo..."
    rustup update
fi

# 3. Bun
if command -v bun &> /dev/null; then
    echo -e "
âš¡ Updating Bun..."
    bun upgrade
fi

# 4. Firmware (LVFS)
if command -v fwupdmgr &> /dev/null; then
    echo -e "
ğŸ’¾ Checking for Firmware Updates..."
    fwupdmgr refresh --force 2>/dev/null
    if fwupdmgr get-updates 2>/dev/null | grep -q "Devices with"; then
        echo "   Updates found. Creating capsule..."
        fwupdmgr update -y
    else
        echo "   Firmware is up to date."
    fi
fi

# 5. Flatpak (if installed)
if command -v flatpak &> /dev/null; then
    echo -e "
ğŸ± Updating Flatpaks..."
    flatpak update -y
fi

# 6. Cleanup
echo -e "
ğŸ§¹ Cleaning up..."
sudo apt autoremove -y
sudo apt clean

echo -e "
âœ… All updates complete!"

read -p "ğŸ“¦ Press Enter to close..."
